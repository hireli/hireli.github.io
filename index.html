<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>入港安全告知书签署</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: "PingFang SC", "Microsoft YaHei", SimSun, sans-serif;
      background: #f9f9f9;
      color: #333;
      line-height: 1.6;
      padding: 12px;
    }
    .container {
      max-width: 100%;
      background: white;
      padding: 18px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      margin: 0 auto;
    }
    h1 {
      font-size: 20px;
      text-align: center;
      margin-bottom: 16px;
      color: #2c3e50;
    }
    #content {
      max-height: calc(40vh); /* 手机上占屏幕 40% 高度 */
      overflow-y: auto;
      border: 1px solid #e0e0e0;
      padding: 14px;
      margin-bottom: 16px;
      border-radius: 8px;
      background: #fafafa;
      font-size: 15px;
      color: #444;
    }
    #signature-pad {
      border: 1px solid #ccc;
      cursor: crosshair;
      background: #fff;
      width: 100%;
      height: 140px;
      border-radius: 8px;
      margin: 10px 0;
    }
    button {
      margin: 10px 0;
      padding: 12px 20px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      background: #1a73e8;
      color: white;
      cursor: pointer;
      width: 100%;
      font-weight: bold;
    }
    button:hover:not(:disabled) {
      background: #0d62c9;
    }
    button:disabled {
      background: #cccccc;
      cursor: not-allowed;
    }
    #clear-btn {
      background: #6c757d;
      width: auto;
      display: inline-block;
    }
    input[type="text"] {
      width: 100%;
      padding: 12px;
      font-size: 16px; /* 防止 iOS 缩放 */
      border: 1px solid #ddd;
      border-radius: 8px;
      margin: 8px 0 16px;
    }
    label {
      display: block;
      margin: 12px 0 8px;
      font-size: 15px;
    }
    input[type="checkbox"] {
      margin-right: 8px;
      transform: scale(1.3);
      vertical-align: middle;
    }
    .agree-label {
      display: flex;
      align-items: flex-start;
      font-size: 15px;
      line-height: 1.5;
    }
    .agree-label span {
      flex: 1;
    }

    /* PDF 模板隐藏 */
    #pdf-template {
      position: absolute;
      left: -9999px;
      top: -9999px;
      opacity: 0;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>外协入场安全告知书签署</h1>

    <!-- 阅读区域 -->
    <div id="content">
      <p>为了确保您在港区内的人身安全，避免出现伤害您或他人的意外发生，现将相关安全事项告知如下：</p>
      <p>一、港区内禁止随意停放车辆，车辆需停在现场管理人员指定区域，人员必须听从现场管理人员指挥；</p>
      <p>二、人员下车时要正确佩戴安全帽，夜间按规定穿戴带有反光标识的劳保防护用品和佩戴警示灯（爆闪灯），并注意躲避运行中的机械、车辆，防止车辆伤害；</p>
      <p>三、港区禁止吸烟，禁止随意丢弃垃圾杂物；</p>
      <p>四、未经允许严禁进入作业场地警戒封闭区域；</p>
      <p>五、现场注意事项</p>
      <p>5.1 进入现场后，严禁在垛空、垛边停留，防止货垛异常出现坍塌或塌方；<br>
      5.2 严禁在高杆灯、皮带机、货关下停留，防止高空坠物或设备倾倒；<br>
      5.3 严禁在机械、车辆运行路线停留或穿行，防止因机械、车辆司机观察不周造成的碰撞或碾压；<br>
      5.4 严禁私自攀爬垛位，防止人员高空滑落或货物流淌掩埋；<br>
      5.5 严禁私自用港区内的设施、机械及私接电源，防止触电或意外伤害；<br>
      5.6 严禁穿行作业封闭区，防止货物打击及机械碰撞；<br>
      5.7 严禁靠近运转中的皮带等设备，防止卷入造成机械伤害；<br>
      5.8 严禁靠近码头边等临边区域，防止坠海淹溺；<br>
      5.9 严禁靠近岸边缆绳区域，防止缆绳抽打伤害；<br>
      5.10 上下大机时请抓稳踏牢，防高处坠落伤害；<br>
      5.11 漏斗、溜筒维修时上方有积料严禁作业，必须积料清理完毕才能开始维修作业；<br>
      5.12 皮带维修须拉至少3处急停，并向中控室确认；<br>
      5.13 现场封闭隔离措施不标准不准开工；<br>
      5.14 急停、停电、挂牌、上锁措施没有执行不准开工，需停高压电的必须办理停电手续；<br>
      5.15 维修人员劳保防护用品穿戴不规范不准开工；<br>
      5.16 特种作业未提供特殊作业资格证件不准开工；<br>
      5.17 特殊作业（登高、动火、临时用电、密闭空间、吊装等）没有办理审批手续不准开工；<br>
      5.18 使用不符合国家规范、标准的工属具、灭火器、仪器仪表不准开工；<br>
      5.19 不得超出项目维修范围的触碰、调试、维修；<br>
      5.20 不得跨越、触碰任何没有确认办理停电的转动、传动、振动功能部件及电气部件，并保持安全距离、采取防护措施；<br>
      5.21 现场不准抽烟、打闹、跳跃、高空抛物，严禁酒后上岗；<br>
      5.22 设备运行关路严禁停留、作业；<br>
      5.23 坠落高度在基准面2米及以上维修必须佩带安全带；<br>
      5.24 维修完毕工完场清，废旧件必须收回；<br>
      5.25 维修作业严格执行《维修联络程序》、《岗位操作规程》。</p>
      <p>六、码头、场区、维修区存在的主要危险<br>
      7.1 行经装载机作业区域伤害；7.2 行经倒运车作业区伤害；7.3 行经散货货物塌落伤害；7.4 行经货关撒货、悠荡伤害；7.5 岸边高压（低压）电伤害；7.6 缆绳断裂抽打伤害；7.7 坠海、坠物伤害；7.8 火灾伤害；7.9 车辆道路交通伤害；7.10 火车伤害；7.11 门机、挖掘机旋转伤害；7.12 上下设备坠落伤害；7.13 雨季坑洼、下水井损坏坠落伤害；7.14 维修作业机械伤害；7.15 有限空间中毒、窒息伤害。</p>
      <p>七、遵守国家法律法规和港口设施保安相关规定；注意港区交通安全标志、安全警示标识、禁令、警戒安全提示，并遵守执行。</p>
      <p>八、维修作业十大风险<br>
      1、高处坠落 2、触电风险 3、绞伤风险 4、挤压风险 5、刺割风险 6、物体打击 7、起重伤害 8、中毒窒息 9、烫、灼伤害 10、火灾、爆炸伤害</p>
      <p>九、维修作业 八项规定<br>
      1、严禁私自上皮带机 2、严禁触摸转动部位 3、严禁违规进入封闭区域 4、严禁无操作设备 5、严禁吸烟 6、必须戴安全帽，劳保穿戴整齐 7、上下走梯必须手扶栏杆 8、开展维修之前必须做好安全措施</p>
      <p>请您认真阅读并严格遵守以上安全注意事项内容。谢谢合作。</p>
    </div>

    <label for="unit-input">请输入单位名称：</label>
    <input type="text" id="unit-input" placeholder="例如：XX建设有限公司" />

    <h3 style="font-size:16px; margin:16px 0 8px;">请在此处手写签名：</h3>
    <canvas id="signature-pad"></canvas>
    <button type="button" id="clear-btn">清除签名</button>

    <!-- 同意条款 -->
    <label class="agree-label">
      <input type="checkbox" id="agree-checkbox" />
      <span>我已认真阅读《入港安全告知书》全部内容，并同意遵守上述安全规定。</span>
    </label>

    <button id="generate-btn" disabled>生成PDF</button>
  </div>

  <!-- PDF 模板（隐藏） -->
  <div id="pdf-template">
    <div class="notice" style="font-family:SimSun;font-size:14px;line-height:1.6;padding:20px;width:210mm;">
      <h2 style="text-align:center;margin-bottom:20px;">入港安全告知书</h2>
      <p>为了确保您在港区内的人身安全，避免出现伤害您或他人的意外发生，现将相关安全事项告知如下：</p>
      <p>一、港区内禁止随意停放车辆，车辆需停在现场管理人员指定区域，人员必须听从现场管理人员指挥；</p>
      <p>二、人员下车时要正确佩戴安全帽，夜间按规定穿戴带有反光标识的劳保防护用品和佩戴警示灯（爆闪灯），并注意躲避运行中的机械、车辆，防止车辆伤害；</p>
      <p>三、港区禁止吸烟，禁止随意丢弃垃圾杂物；</p>
      <p>四、未经允许严禁进入作业场地警戒封闭区域；</p>
      <p>五、现场注意事项</p>
      <p>5.1 进入现场后，严禁在垛空、垛边停留，防止货垛异常出现坍塌或塌方；<br>
      5.2 严禁在高杆灯、皮带机、货关下停留，防止高空坠物或设备倾倒；<br>
      5.3 严禁在机械、车辆运行路线停留或穿行，防止因机械、车辆司机观察不周造成的碰撞或碾压；<br>
      5.4 严禁私自攀爬垛位，防止人员高空滑落或货物流淌掩埋；<br>
      5.5 严禁私自用港区内的设施、机械及私接电源，防止触电或意外伤害；<br>
      5.6 严禁穿行作业封闭区，防止货物打击及机械碰撞；<br>
      5.7 严禁靠近运转中的皮带等设备，防止卷入造成机械伤害；<br>
      5.8 严禁靠近码头边等临边区域，防止坠海淹溺；<br>
      5.9 严禁靠近岸边缆绳区域，防止缆绳抽打伤害；<br>
      5.10 上下大机时请抓稳踏牢，防高处坠落伤害；<br>
      5.11 漏斗、溜筒维修时上方有积料严禁作业，必须积料清理完毕才能开始维修作业；<br>
      5.12 皮带维修须拉至少3处急停，并向中控室确认；<br>
      5.13 现场封闭隔离措施不标准不准开工；<br>
      5.14 急停、停电、挂牌、上锁措施没有执行不准开工，需停高压电的必须办理停电手续；<br>
      5.15 维修人员劳保防护用品穿戴不规范不准开工；<br>
      5.16 特种作业未提供特殊作业资格证件不准开工；<br>
      5.17 特殊作业（登高、动火、临时用电、密闭空间、吊装等）没有办理审批手续不准开工；<br>
      5.18 使用不符合国家规范、标准的工属具、灭火器、仪器仪表不准开工；<br>
      5.19 不得超出项目维修范围的触碰、调试、维修；<br>
      5.20 不得跨越、触碰任何没有确认办理停电的转动、传动、振动功能部件及电气部件，并保持安全距离、采取防护措施；<br>
      5.21 现场不准抽烟、打闹、跳跃、高空抛物，严禁酒后上岗；<br>
      5.22 设备运行关路严禁停留、作业；<br>
      5.23 坠落高度在基准面2米及以上维修必须佩带安全带；<br>
      5.24 维修完毕工完场清，废旧件必须收回；<br>
      5.25 维修作业严格执行《维修联络程序》、《岗位操作规程》。</p>
      <p>六、码头、场区、维修区存在的主要危险<br>
      7.1 行经装载机作业区域伤害；7.2 行经倒运车作业区伤害；7.3 行经散货货物塌落伤害；7.4 行经货关撒货、悠荡伤害；7.5 岸边高压（低压）电伤害；7.6 缆绳断裂抽打伤害；7.7 坠海、坠物伤害；7.8 火灾伤害；7.9 车辆道路交通伤害；7.10 火车伤害；7.11 门机、挖掘机旋转伤害；7.12 上下设备坠落伤害；7.13 雨季坑洼、下水井损坏坠落伤害；7.14 维修作业机械伤害；7.15 有限空间中毒、窒息伤害。</p>
      <p>七、遵守国家法律法规和港口设施保安相关规定；注意港区交通安全标志、安全警示标识、禁令、警戒安全提示，并遵守执行。</p>
      <p>八、维修作业十大风险<br>
      1、高处坠落 2、触电风险 3、绞伤风险 4、挤压风险 5、刺割风险 6、物体打击 7、起重伤害 8、中毒窒息 9、烫、灼伤害 10、火灾、爆炸伤害</p>
      <p>九、维修作业 八项规定<br>
      1、严禁私自上皮带机 2、严禁触摸转动部位 3、严禁违规进入封闭区域 4、严禁无操作设备 5、严禁吸烟 6、必须戴安全帽，劳保穿戴整齐 7、上下走梯必须手扶栏杆 8、开展维修之前必须做好安全措施</p>
      <p>请您认真阅读并严格遵守以上安全注意事项内容。谢谢合作。</p>

      <p style="margin-top:40px;">单位：<span id="filled-unit">__________</span></p>
      <p>被告知人签名：</p>
      <img id="signature-img" src="" alt="签名" style="max-height:80px; border:1px solid #ccc;" />
      <p style="margin-top:20px;">日照港 技术创新中心南区维修中心</p>
      <p id="filled-date">2025年__月__日</p>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script>
    const canvas = document.getElementById('signature-pad');
    const ctx = canvas.getContext('2d');

    function resizeCanvas() {
      const displayWidth = canvas.offsetWidth;
      const displayHeight = canvas.offsetHeight;
      const ratio = Math.max(window.devicePixelRatio || 1, 1);
      canvas.width = displayWidth * ratio;
      canvas.height = displayHeight * ratio;
      ctx.scale(ratio, ratio);
      ctx.lineWidth = 2;
      ctx.lineCap = 'round';
      ctx.strokeStyle = '#000';
    }

    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    let isDrawing = false;

    function getPos(e) {
      const rect = canvas.getBoundingClientRect();
      return {
        x: (e.clientX || (e.touches?.[0]?.clientX ?? 0)) - rect.left,
        y: (e.clientY || (e.touches?.[0]?.clientY ?? 0)) - rect.top
      };
    }

    canvas.addEventListener('mousedown', (e) => {
      isDrawing = true;
      const pos = getPos(e);
      ctx.beginPath();
      ctx.moveTo(pos.x, pos.y);
    });

    canvas.addEventListener('mousemove', (e) => {
      if (!isDrawing) return;
      const pos = getPos(e);
      ctx.lineTo(pos.x, pos.y);
      ctx.stroke();
    });

    canvas.addEventListener('mouseup', () => isDrawing = false);
    canvas.addEventListener('mouseout', () => isDrawing = false);

    canvas.addEventListener('touchstart', (e) => {
      e.preventDefault();
      isDrawing = true;
      const pos = getPos(e);
      ctx.beginPath();
      ctx.moveTo(pos.x, pos.y);
    });

    canvas.addEventListener('touchmove', (e) => {
      e.preventDefault();
      if (!isDrawing) return;
      const pos = getPos(e);
      ctx.lineTo(pos.x, pos.y);
      ctx.stroke();
    });

    canvas.addEventListener('touchend', (e) => {
      e.preventDefault();
      isDrawing = false;
    });

    document.getElementById('clear-btn').addEventListener('click', () => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    });

    function hasSignature() {
      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height).data;
      for (let i = 3; i < imageData.length; i += 4) {
        if (imageData[i] > 0) return true;
      }
      return false;
    }

    const agreeCheckbox = document.getElementById('agree-checkbox');
    const generateBtn = document.getElementById('generate-btn');

    agreeCheckbox.addEventListener('change', () => {
      generateBtn.disabled = !agreeCheckbox.checked;
    });

    generateBtn.addEventListener('click', () => {
      const unit = document.getElementById('unit-input').value.trim();
      if (!unit) {
        alert('请输入单位名称！');
        return;
      }
      if (!hasSignature()) {
        alert('请先完成签名！');
        return;
      }
      if (!agreeCheckbox.checked) {
        alert('请先阅读并勾选“我已阅读并同意”！');
        return;
      }

      document.getElementById('filled-unit').textContent = unit;
      document.getElementById('signature-img').src = canvas.toDataURL('image/png');

      const now = new Date();
      const year = now.getFullYear();
      const month = String(now.getMonth() + 1).padStart(2, '0');
      const day = String(now.getDate()).padStart(2, '0');
      document.getElementById('filled-date').textContent = `${year}年${month}月${day}日`;

      const element = document.querySelector('#pdf-template .notice');
      const opt = {
        margin: 10,
        filename: '入港安全告知书.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2, useCORS: true },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };

      html2pdf().set(opt).from(element).save();
    });
  </script>
</body>
</html>